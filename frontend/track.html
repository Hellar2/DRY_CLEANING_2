<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Track Your Order</title>
<link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="tracking-container">
    <h2>üß∫ Dry Cleaning Order Tracker</h2>
    <p id="trackingId"></p>
    <p id="status"></p>
  </div>

  <script>
    // Example: http://localhost:5002/track/ORD-20251106-12345
    const urlParts = window.location.pathname.split('/');
    const trackingCode = urlParts[urlParts.length - 1];
    document.getElementById('trackingId').textContent = "Tracking Code: " + trackingCode;

    // Fetch order data from backend instead of localStorage
    async function trackOrder() {
      try {
        const response = await fetch(`http://localhost:5002/api/customer/track/${trackingCode}`);
        
        if (!response.ok) {
          document.getElementById('status').textContent = "‚ùå No order found with this tracking code.";
          return;
        }
        
        const order = await response.json();
        
        if (order) {
          document.getElementById('status').textContent = "Current Status: " + (order.status || 'UNKNOWN').toUpperCase();
        } else {
          document.getElementById('status').textContent = "‚ùå No order found with this tracking code.";
        }
      } catch (error) {
        console.error('Error tracking order:', error);
        document.getElementById('status').textContent = "‚ùå Error tracking order. Please try again later.";
      }
    }
    
    // Call the tracking function
    trackOrder();
  </script>
</body>
</html>
